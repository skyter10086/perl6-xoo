version: 2
jobs:
  build:
    docker:
      - image: ubuntu:14.04
      - image: sqlite
    
    working_directory: ~/proj

    steps:
      - checkout

      - run: |
        sudo apt install libsqlite3-dev
        git clone https://github.com/tadzik/rakudobrew ~/.rakudobrew
        export PATH=~/.rakudobrew/bin:$PATH
        rakudobrew init
        rakudobrew build moar
        rakudobrew build zef
        zef install --deps-only .
        zef test .
