version: 2
jobs:
  build:
    docker:
      - image: circleci/buildpack-deps:19.04
    
    working_directory: ~/proj

    steps:
      - checkout
      - run: sudo apt install -y libsqlite3-0
      - run: git clone https://github.com/tadzik/rakudobrew ~/.rakudobrew
      - run:
        - environment:
          PATH: "~/.rakudobrew/bin:$PATH"
      - run: echo $PATH
      - run: find ~/.rakudobrew/bin
      - run: rakudobrew init
      - run: rakudobrew build moar
      - run: rakudobrew build zef
      - run: zef install --deps-only .
      - run: zef test .
